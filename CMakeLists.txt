PROJECT(yunit CXX C)
CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

# ENABLE_TESTING()

SET(EXECUTABLE_OUTPUT_PATH "${PROJECT_BINARY_DIR}/../_bin" CACHE INTERNAL "")
SET(LIBRARY_OUTPUT_PATH "${PROJECT_BINARY_DIR}/../_lib" CACHE INTERNAL "")

ADD_SUBDIRECTORY(lua)
ADD_SUBDIRECTORY(lfs)
ADD_SUBDIRECTORY(ts_modules)
ADD_SUBDIRECTORY(yunit)

SET(CPACK_PACKAGE_NAME "yUnit")
SET(CPACK_PACKAGE_DESCRIPTION_SUMMARY "yUnit (Yet another xUnit)")
SET(CPACK_PACKAGE_VENDOR "Ivan Efimov aka MuteSpirit")
SET(CPACK_PACKAGE_CONTACT "mutespirit@gmail.com")
SET(CPACK_PACKAGE_DESCRIPTION_FILE "${CMAKE_CURRENT_SOURCE_DIR}/readme.txt")
SET(CPACK_RESOURCE_FILE_LICENSE "${CMAKE_CURRENT_SOURCE_DIR}/copyright.txt")
SET(CPACK_PACKAGE_VERSION_MAJOR "0")
SET(CPACK_PACKAGE_VERSION_MINOR "3")
SET(CPACK_PACKAGE_VERSION_PATCH "8")

SET(CPACK_SOURCE_GENERATOR "TBZ2;TGZ;ZIP")

IF(WIN32 AND NOT UNIX)
    # There is a bug in NSI that does not handle full unix paths properly. Make
    # sure there is at least one set of four (4) backlasshes.
    SET(CPACK_GENERATOR "NSIS")
    SET(CPACK_NSIS_DISPLAY_NAME "${CPACK_PACKAGE_INSTALL_DIRECTORY} yUnit (Yet another xUnit)")
    SET(CPACK_NSIS_HELP_LINK "http:\\\\\\\\code.google.com/p/yunit/")
    SET(CPACK_NSIS_CONTACT "mutespirit@gmail.com")
    SET(CPACK_NSIS_MODIFY_PATH ON)
ELSE(WIN32 AND NOT UNIX)
    SET(CPACK_GENERATOR "DEB")
    SET(CPACK_DEBIAN_PACKAGE_SECTION "Developer Tools")
ENDIF(WIN32 AND NOT UNIX)
    
INCLUDE(CPack)
